<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Chi tiết sản phẩm</title>
  <link rel="stylesheet" href="phonggym.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header class="site-header">
    <div class="header-inner">

      <!-- ==== LOGO + DANH MỤC ==== -->
      <div class="left-block">
        <div class="logo-catalog">
          <a href="TrangChu.html" class="brand">
            <img src="/IMG/logo1.png" alt="logo" />
          </a>
          <div class="catalog-btn"><i class="fa fa-bars"></i> Danh Mục Sản Phẩm</div>
        </div>
      </div>

      <!-- ==== THANH TÌM KIẾM ==== -->
      <div class="center-block">
        <div class="search">
          <input id="searchInput" type="search" placeholder="Tìm kiếm bài viết hoặc thông tin..." autocomplete="off">
          <button id="searchBtn">Tìm Kiếm</button>
        </div>
      </div>

      <!-- ==== TÀI KHOẢN / YÊU THÍCH / GIỎ HÀNG ==== -->
      <div class="right-block">
        <button class="icon-btn"><i class="fa-regular fa-user"></i><span> Tài Khoản</span></button>
        <button class="icon-btn"><i class="fa-regular fa-heart"></i></button>
        <div id="cartBtn" class="cart icon-btn"><i class="fa-solid fa-cart-shopping"></i><span id="cartCount">0</span></div>
      </div>

    </div>
  </header>
<section class="promo-banner">
    <img src="/IMG/giam gia.png" alt="promo banner" onerror="this.style.display='none'">
  </section>
  <main class="container" style="max-width:1200px;margin:20px auto;padding:0 18px">
    <div id="productDetail">Đang tải...</div>
  </main>

 <footer class="site-footer">
    <div class="footer-top">
      <div class="ft-icons">
        <div class="ft-icon"><i class="fa-solid fa-truck-fast"></i>
          <h5>HỖ TRỢ PHÍ SHIP</h5>
          <p>100% Hỗ Trợ Toàn Quốc</p>
        </div>
        <div class="ft-icon"><i class="fa-solid fa-tag"></i>
          <h5>GIÁ NIÊM YẾT</h5>
          <p>100% Giá Niêm Yết</p>
        </div>
        <div class="ft-icon"><i class="fa-solid fa-headset"></i>
          <h5>TRUNG TÂM CHĂM SÓC</h5>
          <p>Hỗ Trợ và Tư Vấn 24/7</p>
        </div>
        <div class="ft-icon"><i class="fa-solid fa-rotate-left"></i>
          <h5>CHÍNH SÁCH TRẢ HÀNG</h5>
          <p>Đổi/Trả Hàng Miễn Phí</p>
        </div>
      </div>

      <div class="footer-cols">
        <div class="ft-col">
          <h4>GIỚI THIỆU</h4>
          <ul>
            <li>Giới Thiệu Công Ty</li>
            <li>Thông Tin Liên Hệ</li>
            <li>Tin Tuyển Dụng</li>
            <li>Kiểm Tra Đơn hàng</li>
          </ul>
        </div>

        <div class="ft-col">
          <h4>TÍCH ĐIỂM</h4>
          <ul>
            <li>Cách Tích Điểm</li>
            <li>Thành Viên VIP</li>
          </ul>
        </div>

        <div class="ft-col">
          <h4>CHI NHÁNH 1</h4>
          <p>Liên Hệ: 0901 415 067</p>
          <p>123 Đường Mới, P.1, Q.1, TP.HCM</p>
        </div>

        <div class="ft-col">
          <h4>CHI NHÁNH 2</h4>
          <p>Liên Hệ: 0901 315 067</p>
          <p>285/66 Cách Mạng Tháng Tám, P.12, Q.10, TP.HCM</p>
        </div>

        <div class="ft-col">
          <h4>CHÍNH SÁCH MUA HÀNG</h4>
          <ul>
            <li>Chính sách bảo mật</li>
            <li>Chính sách giao hàng</li>
            <li>Chính sách đổi trả</li>
            <li>Phản hồi chất lượng phục vụ</li>
          </ul>
        </div>
      </div>

      <div class="footer-extras">                                             
        <div class="social">
          <h5>THEO DÕI SHOP TẠI:</h5>
          <a href="https://www.facebook.com/woocs.junz"><i class="fab fa-facebook-f"></i></a>
          <a href="https://www.instagram.com/_woocs.junz_/"><i class="fab fa-instagram"></i></a>
        </div>

        <div class="tax">
          <h5>MÃ SỐ THUẾ:</h5>
          <div>3603416620</div>
          <div style="margin-top:6px; font-weight:700">CÔNG TY TNHH NHỊ GIA NGUYỄN</div>
          <div>6/3 Kp.1, P. Tân Hòa, Tp Biên Hòa, Tỉnh Đồng Nai</div>
        </div>

        <div class="bct">
          <h5>ĐÃ THÔNG BÁO</h5>
          <img src="/IMG/bocongthuong.png" alt="Đã thông báo Bộ Công Thương" style="max-width:140px;">
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div>© 2025 YOUNGKH WHEY</div>
      <div>Đăng ký: 2/11/2025</div>
    </div>
  </footer>

  <script src="phonggym.js"></script>
  <script>
    (function(){
      const root = document.getElementById('productDetail');
      function q(name){ return new URLSearchParams(location.search).get(name); }
      const id = parseInt(q('id')) || null;
      if (!root) { console.error('productDetail root not found'); return; }
      if (!id) {
        root.innerHTML = '<p>Không tìm thấy sản phẩm (id không hợp lệ).</p>';
        return;
      }

      const productList = (typeof products !== 'undefined') ? products : (window.products || []);
      const p = (productList || []).find(x => x.id === id);
      if (!p) {
        root.innerHTML = '<p>Không tìm thấy sản phẩm với id=' + id + '</p>';
        return;
      }

      const gallery = Array.isArray(p.images) && p.images.length ? p.images : [p.img];
      const related = (productList || []).filter(x => x.category === p.category && x.id !== p.id).slice(0,3);

      root.innerHTML = `
        <div class="product-detail">
          <div class="pd-gallery">
            <div class="pd-mainimg">
              ${p.badge ? `<span class="badge large">${p.badge}</span>` : ''}
              <img id="pdMainImg" src="${gallery[0]}" alt="${p.title}">
            </div>
            <ul class="pd-thumbs">
              ${gallery.map((g,i)=>`<li ${i===0? 'class="active"':''} data-src="${g}"><img src="${g}"/></li>`).join('')}
            </ul>
          </div>

          <div class="pd-info">
            <div class="pd-supplier">Nhà cung cấp: <strong>${p.supplier||'N/A'}</strong></div>
            <h1 class="pd-title">${p.title}</h1>
            <div class="pd-views"><i class="fa-regular fa-eye"></i> 10 người đang xem sản phẩm tại lúc này</div>

            <div class="pd-price-row">
              ${p.oldPrice ? `<div class="old-price">${formatPrice(p.oldPrice)}</div>` : ''}
              <div class="price">${formatPrice(p.price)}</div>
            </div>
            ${p.oldPrice ? `<div class="pd-discount">Giảm giá: ${formatPrice((p.oldPrice||0)-p.price)} (${ Math.round(((p.oldPrice-p.price)/p.oldPrice)*100) }%)</div>` : ''}

            ${p.variants && p.variants.length ? `
              <div class="pd-variants">
                <div class="variant-label">Chọn mùi:</div>
                <div class="variant-list">${p.variants.map(v=>`<button class="variant-btn">${v}</button>`).join('')}</div>
              </div>
            ` : ''}

            <div class="pd-deals">
              <h4>Chọn thêm để tiết kiệm</h4>
              ${related.length ? related.map(r=>`
                <div class="deal-row ${r.stock===false?'out':''}">
                  <img src="${r.img}" alt="${r.title}">
                  <div class="deal-info">
                    <div class="deal-title">${r.title}</div>
                    <div class="deal-price">${formatPrice(r.price)} ${r.oldPrice?`<span class="old-price-small">${formatPrice(r.oldPrice)}</span>`:''}</div>
                  </div>
                </div>
              `).join('') : '<div class="muted">Không có ưu đãi thêm.</div>'}
            </div>

            <div class="pd-purchase">
              <div class="qty-control">
                <button id="qtyMinus" class="qty-btn">-</button>
                <input id="qtyInput" type="number" value="1" min="1">
                <button id="qtyPlus" class="qty-btn">+</button>
              </div>
              <button id="orderBtn" class="btn-order">ĐẶT HÀNG</button>
            </div>

            <div class="pd-extra">
              <a href="javascript:history.back()" class="btn-outline">Quay lại</a>
            </div>
          </div>
        </div>
      `;

      // thumbnails
      const mainImg = document.getElementById('pdMainImg');
      document.querySelectorAll('.pd-thumbs li').forEach(li => li.addEventListener('click', ()=>{
        document.querySelectorAll('.pd-thumbs li').forEach(x=>x.classList.remove('active'));
        li.classList.add('active');
        const s = li.getAttribute('data-src'); if (s) mainImg.src = s;
      }));

      // qty controls
      const qtyInput = document.getElementById('qtyInput');
      document.getElementById('qtyPlus').addEventListener('click', ()=> qtyInput.value = Math.max(1, parseInt(qtyInput.value||1)+1));
      document.getElementById('qtyMinus').addEventListener('click', ()=> qtyInput.value = Math.max(1, parseInt(qtyInput.value||1)-1));

      // order
      document.getElementById('orderBtn').addEventListener('click', ()=>{
        const qty = Math.max(1, parseInt(qtyInput.value||1));
        for(let i=0;i<qty;i++) addToCart(p.id);
        alert('Đã thêm ' + qty + ' x "' + p.title + '" vào giỏ hàng.');
      });

      window.scrollTo({top:0, behavior:'smooth'});
    })();
  </script>
</body>
</html>